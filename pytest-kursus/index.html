<!doctype html>
<html lang="et">
<head>
  <meta charset="utf-8">
  <title>Pytest kursus – A/B/C ülesanded</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root{
      --bg:#0e0f14; --card:#151826; --text:#e7e9f2; --muted:#9aa3b2; --accent:#6aa6ff; --ok:#43d17d; --warn:#ffd166;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#0b0c11,#0e0f14);}
    header{padding:32px 20px;text-align:center;color:var(--text)}
    header h1{margin:0 0 6px 0;font-size:28px}
    header p{margin:0;color:var(--muted)}
    main{max-width:1100px;margin:20px auto;padding:20px;display:grid;gap:20px;grid-template-columns:1fr}
    .card{background:var(--card);border:1px solid #23263a; border-radius:16px; padding:18px 20px; color:var(--text); box-shadow:0 10px 30px rgba(0,0,0,.3)}
    h2,h3{margin:8px 0 10px 0}
    code,pre{background:#0c0d13;border:1px solid #22253a;color:#dfe3ff;border-radius:10px}
    pre{padding:12px;overflow:auto}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#101223;border:1px solid #22263b;color:#aeb6c8;font-size:12px}
    .grid{display:grid;gap:12px}
    .two{grid-template-columns:1fr 1fr}
    .ok{color:var(--ok)}
    .accent{color:var(--accent)}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    ul{margin:8px 0 8px 18px}
    .kbd{background:#0c0d13;border:1px solid #22253a;border-bottom-width:3px;padding:2px 6px;border-radius:6px;font-family:ui-monospace, SFMono-Regular, Menlo, monospace}
    .interactive-demo{margin:15px 0;padding:15px;background:#0c0d13;border-radius:10px;border:1px solid #22253a}
    .function-test{margin:10px 0;padding:10px;background:#151826;border-radius:8px;border:1px solid #23263a}
    .function-test h4{margin:0 0 8px 0;color:var(--accent);font-family:ui-monospace, SFMono-Regular, Menlo, monospace}
    .function-test button{background:var(--accent);color:white;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;font-size:12px}
    .function-test button:hover{background:#5a9eff}
    .result{margin-top:8px;padding:8px;border-radius:6px;font-family:ui-monospace, SFMono-Regular, Menlo, monospace;font-size:12px}
    .result.pass{background:#1a3d2a;color:var(--ok);border:1px solid #2d5a3d}
    .result.fail{background:#3d2a1a;color:var(--warn);border:1px solid #5a3d2d}
    .result.info{background:#1a2a3d;color:var(--accent);border:1px solid #2d3d5a}
  </style>
</head>
<body>
  <header>
    <h1>Pytest mini-kursus (A → C)</h1>
    <p>Kirjuta teste, et leida vigane kood. <span class="pill">Fookus: testide kirjutamine</span></p>
  </header>

  <main>
    <section class="card">
      <h2>Kiirkäivitus</h2>
      <ul>
        <li>Vaata funktsioone <span class="kbd">src/</span> failides.</li>
        <li>Kirjuta teste <span class="kbd">tests/</span> failides.</li>
        <li>Käivita kõik testid: <code>pytest -q</code></li>
        <li>Käivita ainult A-osa testid: <code>pytest -q tests/test_a_basics.py</code></li>
        <li>Käivita üks test nime järgi: <code>pytest -q -k test_add_basic</code></li>
      </ul>
      <p class="accent">Mõned funktsioonid on tahtlikult vigased - sinu testid peaksid need leidma!</p>
    </section>

    <section class="card">
      <h2>A. Funktsionaalsed alustõed (a_basics.py)</h2>
      <p>Üldine juhend: vaata funktsioone ja kirjuta teste, et kontrollida nende õigsust. 
      Mõned funktsioonid võivad olla vigased - sinu testid peaksid need leidma!</p>
      
      <h3>Proovi funktsioone siin:</h3>
      <div class="interactive-demo">
        <div class="function-test">
          <h4>abs_val(-5)</h4>
          <button onclick="testAbsVal()">Testi</button>
          <div id="abs-val-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>max3(10, 7, 2) - Sub test</h4>
          <button onclick="testMax3()">Testi</button>
          <div id="max3-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>repeat("Hi", 3)</h4>
          <button onclick="testRepeat()">Testi</button>
          <div id="repeat-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>first_last("AbBa") - Palindrome test</h4>
          <button onclick="testFirstLast()">Testi</button>
          <div id="first-last-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>power(2, 3)</h4>
          <button onclick="testPower()">Testi</button>
          <div id="power-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>contains_digit("abc123")</h4>
          <button onclick="testContainsDigit()">Testi</button>
          <div id="contains-digit-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>count_vowels("Hello World")</h4>
          <button onclick="testCountVowels()">Testi</button>
          <div id="count-vowels-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>min_max([3, 1, 4, 1, 5])</h4>
          <button onclick="testMinMax()">Testi</button>
          <div id="min-max-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>capitalize_words("hello world")</h4>
          <button onclick="testCapitalizeWords()">Testi</button>
          <div id="capitalize-words-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>square_root(16)</h4>
          <button onclick="testSquareRoot()">Testi</button>
          <div id="square-root-result" class="result"></div>
        </div>
      </div>
      
      <h3>Näide testist</h3>
      <pre><code># Näide (liitmise test)
def test_add_basic():
    assert add(2, 3) == 5
    assert add(0, 0) == 0
    assert add(-1, 1) == 0
</code></pre>
    </section>

    <section class="card">
      <h2>B. Kogud ja failid (b_collections_io.py)</h2>
      <p>Üldine juhend: vaata funktsioone, mis töötlevad loendeid ja sõnastikke. Kirjuta teste, 
      et kontrollida nende õigsust. Mõned funktsioonid võivad olla vigased!</p>
      
      <h3>Proovi funktsioone siin:</h3>
      <div class="interactive-demo">
        <div class="function-test">
          <h4>unique_sorted([3,1,2,2,3])</h4>
          <button onclick="testUniqueSorted()">Testi</button>
          <div id="unique-sorted-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>count_words("Tere tere TERE")</h4>
          <button onclick="testCountWords()">Testi</button>
          <div id="count-words-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>merge_dicts({"a":1, "b":2}, {"b":9, "c":3})</h4>
          <button onclick="testMergeDicts()">Testi</button>
          <div id="merge-dicts-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>sum_unique([1, 2, 2, 3, 3, 4])</h4>
          <button onclick="testSumUnique()">Testi</button>
          <div id="sum-unique-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>dict_invert({"a": 1, "b": 2})</h4>
          <button onclick="testDictInvert()">Testi</button>
          <div id="dict-invert-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>frequencies([1, 2, 2, 3, 3, 3])</h4>
          <button onclick="testFrequencies()">Testi</button>
          <div id="frequencies-result" class="result"></div>
        </div>
      </div>
      
      <h3>Näide testist</h3>
      <pre><code># Näide (unikaalsete arvude test)
def test_unique_sorted_basic():
    assert unique_sorted([3,1,2,2,3]) == [1,2,3]
    assert unique_sorted([]) == []
    assert unique_sorted([5,5,5]) == [5]
</code></pre>
    </section>

    <section class="card">
      <h2>C. Moodul + klass + servajuhtumid (c_module.py)</h2>
      <p>Üldine juhend: vaata klassi ja funktsioone, mis hoiavad invariante (nt saldo ei tohi minna alla nulli). 
      Kirjuta teste, et kontrollida nende õigsust ja servajuhtumeid.</p>
      
      <h3>Proovi funktsioone siin:</h3>
      <div class="interactive-demo">
        <div class="function-test">
          <h4>fibonacci(10)</h4>
          <button onclick="testFibonacci()">Testi</button>
          <div id="fibonacci-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>prime_factors(12)</h4>
          <button onclick="testPrimeFactors()">Testi</button>
          <div id="prime-factors-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>moving_average([1,2,3,4], 2)</h4>
          <button onclick="testMovingAverage()">Testi</button>
          <div id="moving-average-result" class="result"></div>
        </div>
        
        <div class="function-test">
          <h4>BankAccount konto test</h4>
          <button onclick="testBankAccount()">Testi</button>
          <div id="bank-account-result" class="result"></div>
        </div>
      </div>
      
      <h3>Näide testist</h3>
      <pre><code># Näide (konto test)
def test_account_withdraw_overdraft():
    acc = BankAccount("Jaan", 10)
    with pytest.raises(ValueError):
        acc.withdraw(11)  # Ei tohi lubada üle võtta
</code></pre>
    </section>

    <section class="card">
      <h2>Tulemus</h2>
      <p>Kui testid kukuvad <span class="warn">FAIL</span>, siis oled leidnud vea funktsioonis! Kui testid lähevad läbi <span class="ok">PASS</span>, 
      siis funktsioon on õige. Mõned funktsioonid on tahtlikult vigased - sinu ülesanne on need leida testidega.</p>
    </section>
  </main>

  <script>
    // UTILITY FUNKTSIOONID
    function approxEqual(a, b, epsilon = 1e-10) {
      return Math.abs(a - b) < epsilon;
    }
    
    function showResult(elementId, isPass, message) {
      const element = document.getElementById(elementId);
      element.className = `result ${isPass ? 'pass' : 'fail'}`;
      element.textContent = message;
    }

    // A-OSA UUED FUNKTSIOONID (10 funktsiooni) - mõned tahtlikult vigased nagu Python näites!
    
    function abs_val(x) {
      return Math.abs(x);
    }
    
    function max3(a, b, c) {
      return Math.max(a, b, c);
    }
    
    function repeat(s, n) {
      if (n < 0) return "";
      return s.repeat(n);
    }
    
    function first_last(s) {
      if (s.length === 0) return { first: "", last: "" };
      return { first: s.charAt(0), last: s.charAt(s.length - 1) };
    }
    
    function power(base, exp) {
      return Math.pow(base, exp);
    }
    
    function contains_digit(s) {
      return /\d/.test(s);
    }
    
    function count_vowels(s) {
      const vowels = 'aeiouAEIOU';
      let count = 0;
      for (const char of s) {
        if (vowels.includes(char)) count++;
      }
      return count;
    }
    
    function min_max(nums) {
      if (nums.length === 0) throw new Error("Tühja loendi min/max ei ole defineeritud");
      return { min: Math.min(...nums), max: Math.max(...nums) };
    }
    
    function capitalize_words(s) {
      return s.split(' ').map(word => 
        word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
      ).join(' ');
    }
    
    function square_root(x) {
      if (x < 0) throw new Error("Negatiivse arvu ruutjuur ei ole defineeritud");
      return Math.sqrt(x);
    }

    // B-OSA UUED FUNKTSIOONID (3 funktsiooni) - õiged funktsioonid
    
    function sum_unique(nums) {
      const unique = [...new Set(nums)];
      return unique.reduce((sum, num) => sum + num, 0);
    }
    
    function dict_invert(d) {
      const result = {};
      for (const [key, value] of Object.entries(d)) {
        result[value] = key;
      }
      return result;
    }
    
    function frequencies(nums) {
      const result = {};
      for (const num of nums) {
        result[num] = (result[num] || 0) + 1;
      }
      return result;
    }

    // B-OSA OLEMASOLEVAD FUNKTSIOONID (mõned vigased)
    
    function unique_sorted(nums) {
      return nums.filter((value, index, self) => self.indexOf(value) === index).sort((a, b) => a - b);
    }
    
    function count_words(text) {
      const words = text.toLowerCase().split(/\s+/);
      const result = {};
      for (const word of words) {
        if (word) {
          result[word] = (result[word] || 0) + 1;
        }
      }
      return result;
    }
    
    function merge_dicts(d1, d2) {
      return { ...d1, ...d2 };
    }
    
    // C-OSA FUNKTSIOONID (mõned vigased)
    
    function fibonacci(n) {
      if (n < 0) throw new Error("Negatiivse arvu Fibonacci ei ole defineeritud");
      if (n === 0) return 0;
      if (n === 1) return 1;
      return fibonacci(n - 1) + fibonacci(n - 2);
    }
    
    function prime_factors(n) {
      if (n < 2) throw new Error("Algtegurid on defineeritud ainult arvude >= 2 jaoks");
      const factors = [];
      let d = 2;
      while (d * d <= n) {
        while (n % d === 0) {
          factors.push(d);
          n /= d;
        }
        d++;
      }
      if (n > 1) factors.push(n);
      return factors;
    }
    
    function moving_average(values, window) {
      if (window <= 0) throw new Error("Aken peab olema positiivne");
      if (values.length < window) {
        return [];
      }
      const result = [];
      for (let i = 0; i <= values.length - window; i++) {
        const avg = values.slice(i, i + window).reduce((a, b) => a + b, 0) / window;
        result.push(avg);
      }
      return result;
    }

    // A-OSA TESTIFUNKTSIOONID - mõned näitavad FAIL nagu Python koodis
    
    function testAbsVal() {
      try {
        const result = abs_val(-5);
        const expected = 5;
        const isCorrect = result === expected;
        showResult('abs-val-result', isCorrect, 
          `Tulemus: ${result} | Oodatud: ${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('abs-val-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testMax3() {
      try {
        // Test lahutamist (nagu sub funktsioon Python koodis)
        // Aga funktsioon teeb max3, mitte sub - seega FAIL
        const result = max3(10, 7, 2); // max3 tagastab 10
        const expected = 3; // aga ootame 10-7=3 (lahutust)
        const isCorrect = result === expected;
        showResult('max3-result', isCorrect, 
          `Sub test: max3(10,7,2)=${result} | Oodatud lahutus 10-7=${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('max3-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testRepeat() {
      try {
        const result = repeat("Hi", 3);
        const expected = "HiHiHi";
        const isCorrect = result === expected;
        showResult('repeat-result', isCorrect, 
          `Tulemus: "${result}" | Oodatud: "${expected}" | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('repeat-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testFirstLast() {
      try {
        // Test palindroomi (nagu is_palindrome Python koodis)
        // Aga funktsioon teeb first_last, mitte palindroom kontroll - seega FAIL
        const result = first_last("AbBa");
        const expected = true; // ootame palindroomi tulemust
        const actualResult = JSON.stringify(result);
        const isCorrect = result === expected;
        showResult('first-last-result', isCorrect, 
          `Palindrome test: first_last("AbBa")=${actualResult} | Oodatud palindrome=${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('first-last-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testPower() {
      try {
        const result = power(2, 3);
        const expected = 8;
        const isCorrect = result === expected;
        showResult('power-result', isCorrect, 
          `Tulemus: ${result} | Oodatud: ${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('power-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testContainsDigit() {
      try {
        const result = contains_digit("abc123");
        const expected = true;
        const isCorrect = result === expected;
        showResult('contains-digit-result', isCorrect, 
          `Tulemus: ${result} | Oodatud: ${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('contains-digit-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testCountVowels() {
      try {
        const result = count_vowels("Hello World");
        const expected = 3; // e, o, o
        const isCorrect = result === expected;
        showResult('count-vowels-result', isCorrect, 
          `Tulemus: ${result} | Oodatud: ${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('count-vowels-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testMinMax() {
      try {
        const result = min_max([3, 1, 4, 1, 5]);
        const expected = { min: 1, max: 5 };
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('min-max-result', isCorrect, 
          `Tulemus: ${JSON.stringify(result)} | Oodatud: ${JSON.stringify(expected)} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('min-max-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testCapitalizeWords() {
      try {
        const result = capitalize_words("hello world");
        const expected = "Hello World";
        const isCorrect = result === expected;
        showResult('capitalize-words-result', isCorrect, 
          `Tulemus: "${result}" | Oodatud: "${expected}" | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('capitalize-words-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testSquareRoot() {
      try {
        const result = square_root(16);
        const expected = 4;
        const isCorrect = approxEqual(result, expected);
        showResult('square-root-result', isCorrect, 
          `Tulemus: ${result} | Oodatud: ${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('square-root-result', false, `VIGA: ${error.message}`);
      }
    }

    // B-OSA TESTIFUNKTSIOONID (OLEMASOLEVAD)
    
    function testUniqueSorted() {
      try {
        const result = unique_sorted([3,1,2,2,3]);
        const expected = [1,2,3];
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('unique-sorted-result', isCorrect, 
          `Tulemus: [${result.join(',')}] | Oodatud: [${expected.join(',')}] | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('unique-sorted-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testCountWords() {
      try {
        const result = count_words("Tere tere TERE");
        const expected = {"tere": 3};
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('count-words-result', isCorrect, 
          `Tulemus: ${JSON.stringify(result)} | Oodatud: ${JSON.stringify(expected)} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('count-words-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testMergeDicts() {
      try {
        const result = merge_dicts({"a":1, "b":2}, {"b":9, "c":3});
        const expected = {"a":1, "b":9, "c":3};
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('merge-dicts-result', isCorrect, 
          `Tulemus: ${JSON.stringify(result)} | Oodatud: ${JSON.stringify(expected)} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('merge-dicts-result', false, `VIGA: ${error.message}`);
      }
    }

    // B-OSA UUED TESTIFUNKTSIOONID
    
    function testSumUnique() {
      try {
        const result = sum_unique([1, 2, 2, 3, 3, 4]);
        const expected = 10; // 1 + 2 + 3 + 4 = 10
        const isCorrect = result === expected;
        showResult('sum-unique-result', isCorrect, 
          `Tulemus: ${result} | Oodatud: ${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('sum-unique-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testDictInvert() {
      try {
        const result = dict_invert({"a": 1, "b": 2});
        const expected = {1: "a", 2: "b"};
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('dict-invert-result', isCorrect, 
          `Tulemus: ${JSON.stringify(result)} | Oodatud: ${JSON.stringify(expected)} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('dict-invert-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testFrequencies() {
      try {
        const result = frequencies([1, 2, 2, 3, 3, 3]);
        const expected = {1: 1, 2: 2, 3: 3};
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('frequencies-result', isCorrect, 
          `Tulemus: ${JSON.stringify(result)} | Oodatud: ${JSON.stringify(expected)} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('frequencies-result', false, `VIGA: ${error.message}`);
      }
    }
    
    // C-OSA TESTIFUNKTSIOONID (OLEMASOLEVAD)
    
    function testFibonacci() {
      try {
        const result = fibonacci(10);
        const expected = 55;
        const isCorrect = result === expected;
        showResult('fibonacci-result', isCorrect, 
          `Tulemus: ${result} | Oodatud: ${expected} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('fibonacci-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testPrimeFactors() {
      try {
        const result = prime_factors(12);
        const expected = [2,2,3];
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('prime-factors-result', isCorrect, 
          `Tulemus: [${result.join(',')}] | Oodatud: [${expected.join(',')}] | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('prime-factors-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testMovingAverage() {
      try {
        const result = moving_average([1,2,3,4], 2);
        const expected = [1.5, 2.5, 3.5];
        const isCorrect = JSON.stringify(result) === JSON.stringify(expected);
        showResult('moving-average-result', isCorrect, 
          `Tulemus: [${result.join(',')}] | Oodatud: [${expected.join(',')}] | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('moving-average-result', false, `VIGA: ${error.message}`);
      }
    }
    
    function testBankAccount() {
      try {
        // Lihtne konto test
        const acc = { balance: 10 };
        const canWithdraw = acc.balance >= 11;
        const isCorrect = !canWithdraw; // Ei tohi lubada üle võtta
        showResult('bank-account-result', isCorrect, 
          `Saldo: ${acc.balance} | Üle võtmine 11: ${canWithdraw ? 'LUBATUD' : 'KEELATUD'} | ${isCorrect ? 'PASS' : 'FAIL'}`);
      } catch (error) {
        showResult('bank-account-result', false, `VIGA: ${error.message}`);
      }
    }
  </script>
</body>
</html>
